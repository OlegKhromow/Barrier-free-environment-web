<aside class="sidebar flex flex-col h-full justify-between">
  <div>
    <ng-container *ngIf="location; else empty">
      <h2 class="text-xl font-bold mb-2 text-green-700">{{ location.name }}</h2>
      <p class="text-gray-600 mb-4">{{ location.address }}</p>

      <!-- –û–ø–∏—Å -->
      <div class="mb-4">
        <h3 class="font-semibold text-gray-800">–û–ø–∏—Å</h3>
        <p class="text-sm text-gray-700">{{ location.description || '–ù–µ–º–∞—î –æ–ø–∏—Å—É' }}</p>
      </div>

      <!-- –ö–∞—Ç–µ–≥–æ—Ä—ñ—è -->
      <div class="mb-4">
        <h3 class="font-semibold text-gray-800">–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</h3>
        <p class="text-sm text-gray-700">{{ location.type?.name }}</p>
        <p class="text-sm text-gray-700">{{ location.type?.description }}</p>
      </div>

      <!-- –ö–æ–Ω—Ç–∞–∫—Ç–∏ -->
      <div class="mb-4">
        <h3 class="font-semibold text-gray-800">–ö–æ–Ω—Ç–∞–∫—Ç–∏</h3>
        <ng-container *ngIf="location.contacts && (location.contacts.phone || location.contacts.email || location.contacts.website); else noContacts">
          <ul class="text-sm text-gray-700">
            <li *ngIf="location.contacts.phone">üìû {{ location.contacts.phone }}</li>
            <li *ngIf="location.contacts.email">‚úâÔ∏è {{ location.contacts.email }}</li>
            <li *ngIf="location.contacts.website">
              üåç <a [href]="location.contacts.website" target="_blank" class="text-blue-600 underline">
              {{ location.contacts.website }}
            </a>
            </li>
          </ul>
        </ng-container>
        <ng-template #noContacts>
          <p class="text-sm text-gray-500">–ù–µ–º–∞—î –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤</p>
        </ng-template>
      </div>

      <!-- –†–æ–∑–∫–ª–∞–¥ -->
      <div class="mb-4">
        <h3 class="font-semibold text-gray-800">–ì—Ä–∞—Ñ—ñ–∫ —Ä–æ–±–æ—Ç–∏</h3>
        <ng-container *ngIf="location?.workingHours && !hasNoSchedule(location.workingHours); else noSchedule">
          <div *ngFor="let d of days">
            <div>{{ d.label }}: {{ getDaySchedule(d.key, location.workingHours) }}</div>
          </div>
        </ng-container>
        <ng-template #noSchedule>
          <p class="text-sm text-gray-500">–ù–µ–º–∞—î —Ä–æ–∑–∫–ª–∞–¥—É</p>
        </ng-template>
      </div>

      <!-- –°—Ç–∞—Ç—É—Å -->
      <div class="mb-4">
        <h3 class="font-semibold text-gray-800">–°—Ç–∞–Ω</h3>
        <ng-container [ngSwitch]="location.status">
          <p *ngSwitchCase="'published'" class="text-sm font-medium text-green-600">–û–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–æ</p>
          <p *ngSwitchCase="'pending'" class="text-sm font-medium text-yellow-600">–û—á—ñ–∫—É—î –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏</p>
          <p *ngSwitchCase="'rejected'" class="text-sm font-medium text-red-600">–í—ñ–¥—Ö–∏–ª–µ–Ω–æ</p>
          <p *ngSwitchDefault class="text-sm font-medium text-gray-500">–ù–µ–≤—ñ–¥–æ–º–∏–π —Å—Ç–∞—Ç—É—Å</p>
        </ng-container>
      </div>

      <!-- –ö—Ä–∏—Ç–µ—Ä—ñ—ó -->
      <div *ngIf="criteriaTree" class="mb-4">
        <div class="ml-1">
          <!-- –ì—Ä—É–ø–∞ -->
          <div class="cursor-pointer select-none font-semibold text-gray-800 flex items-center"
               (click)="toggleGroup()">
            <span [class.rotate-90]="showGroup" class="mr-1 transition-transform duration-200">‚ñ∂</span>
            {{ criteriaTree.group.name }}
          </div>

          <div *ngIf="showGroup" class="ml-4 mt-2 transition-all duration-200">
            <div *ngFor="let type of criteriaTree.group.types" class="mb-2">
              <!-- –¢–∏–ø -->
              <div class="cursor-pointer select-none flex items-center text-gray-700"
                   (click)="toggleType(type)">
                <span [class.rotate-90]="isTypeOpen(type)" class="mr-1 transition-transform duration-200">‚ñ∂</span>
                <strong>{{ type.name }}</strong>
              </div>

              <!-- –ö—Ä–∏—Ç–µ—Ä—ñ—ó -->
              <ul *ngIf="isTypeOpen(type)" class="ml-6 list-disc text-sm text-gray-700 mt-1">
                <li *ngFor="let c of type.criterias">
                  {{ c.description }} <small class="text-gray-500">({{ c.rank }})</small>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </ng-container>

    <ng-template #empty>
      <div class="flex flex-col items-center justify-center h-full text-center">
        <h1 class="font-semibold text-2xl mb-3">–í–∏–±–µ—Ä—ñ—Ç—å –ª–æ–∫–∞—Ü—ñ—é<br>–Ω–∞ –∫–∞—Ä—Ç—ñ</h1>
        <img ngSrc="assets/hand-point.png" alt="hand point" height="128" width="128">
      </div>
    </ng-template>
  </div>

  <!-- –ù–∏–∂–Ω—ñ–π –±–ª–æ–∫ (–¥—É–±–ª—ñ–∫–∞—Ç) -->
  <div *ngIf="duplicateMode && location" class="mt-4 border-t pt-3">
    <p class="font-medium text-gray-700 mb-2">–¶–µ –≤–∞—à–∞ –ª–æ–∫–∞—Ü—ñ—è?(–ø–µ—Ä–µ–π—Ç–∏ –¥–æ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è)</p>
    <div class="flex gap-3">
      <button (click)="confirmYes()" class="px-4 py-2 rounded bg-green-600 text-white hover:bg-green-700">–¢–∞–∫</button>
      <button (click)="confirmNo()" class="px-4 py-2 rounded bg-gray-200 hover:bg-gray-300">–ù—ñ</button>
    </div>
  </div>

  <!-- –ù–∏–∂–Ω—ñ–π –±–ª–æ–∫ —ñ–∑ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º–∏ -->
  <div *ngIf="location" class="mt-6 border-t pt-4 text-sm text-gray-700 space-y-2">
    <p>
      –î–∞–π—Ç–µ –æ—Ü—ñ–Ω–∫—É –ª–æ–∫–∞—Ü—ñ—ó –∑–≥—ñ–¥–Ω–æ –∫—Ä–∏—Ç–µ—Ä—ñ—è–º –±–µ–∑–±–∞—Ä'—î—Ä–Ω–æ—Å—Ç—ñ:
      <a [routerLink]="['/evaluate', location.id]" class="text-blue-600 underline hover:text-blue-800">
        –ü–µ—Ä–µ–π—Ç–∏ –¥–æ –æ—Ü—ñ–Ω–∫–∏ –ª–æ–∫–∞—Ü—ñ—ó
      </a>
    </p>

    <p *ngIf="!duplicateMode">
      –•–æ—á–µ—Ç–µ –æ–Ω–æ–≤–∏—Ç–∏ –¥–∞–Ω—ñ –ª–æ–∫–∞—Ü—ñ—ó?
      <a href="#" class="text-blue-600 underline hover:text-blue-800">–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –≤–Ω–µ—Å–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö</a>
    </p>
  </div>
</aside>
