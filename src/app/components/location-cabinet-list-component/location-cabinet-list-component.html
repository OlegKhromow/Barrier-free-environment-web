<div class="space-y-6">
  <h1 class="text-2xl font-semibold mb-4">Список локацій</h1>

  <div *ngIf="loading" class="p-4 bg-gray-50 rounded shadow">Завантаження...</div>
  <div *ngIf="error" class="p-4 bg-red-100 text-red-700 rounded shadow">{{ error }}</div>

  <div class="mt-3 mb-1 flex flex-wrap items-center md:w-7/8 gap-3">
    <p class="font-semibold mr-2">Фільтрування:</p>

    <!-- Назва локацій -->
    <input class="flex-1 min-w-0 p-2 text-base border-2 border-black rounded-md"
           type="text" placeholder="Назва локації..." [(ngModel)]="filterTitle">

    <!-- Опис локацій -->
    <input class="flex-1 min-w-0 ml-2 p-2 text-base border-2 border-black rounded-md"
           type="text" placeholder="Опис локації..." [(ngModel)]="filterDescription">

    <!-- Типи локацій -->
    <select [(ngModel)]="selectedTypeId"
            class="p-2 border-2 border-black rounded-md">
      <option value="all">Усі типи</option>
      <option *ngFor="let t of locationTypes" [value]="t.id">{{ t.name }}</option>
    </select>

    <!-- Статуси -->
    <select [(ngModel)]="selectedStatus"
            class="p-2 border-2 border-black rounded-md">
      <option value="all">Усі статуси</option>
      <option *ngFor="let s of statuses" [value]="s">{{ s | titlecase }}</option>
    </select>

    <svg
      (click)="clearFiltersInputs()"
      xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
      class="w-10 h-10 ml-2 cursor-pointer flex-shrink-0">
      <path stroke-linecap="round" stroke-linejoin="round"
            d="m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
    </svg>

  </div>

  <div *ngIf="!loading && !error">
    <div *ngIf="locations.length; else emptyList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      <a *ngFor="let loc of locations |
            elementsByString:
            ['name', 'description'] :
            [filterTitle, filterDescription]  :
            selectedTypeId:
            selectedStatus
            | paginate: pagingConfig"
         [routerLink]="['/user-location', loc.id]"
         class="block bg-white border rounded-lg p-4 shadow hover:shadow-md transition hover:bg-gray-50 cursor-pointer">

        <div class="flex justify-between items-center mb-2">
          <div class="font-semibold text-lg">{{ loc.name }}</div>
          <div class="flex flex-col items-end space-y-1">
            <span *ngIf="loc.status === 'pending'"
                  class="text-xs bg-yellow-200 text-yellow-800 px-2 py-1 rounded">
              Очікує підтвердження
            </span>
            <span *ngIf="loc.status === 'rejected'"
                  class="text-xs bg-red-600 text-white px-2 py-1 rounded">
              Відхилено
            </span>
            <span *ngIf="ifPending(loc.id)"
                  class="text-xs bg-blue-200 text-blue-800 px-2 py-1 rounded">
              Оновлення очікує підтвердження
            </span>
          </div>
        </div>

        <div class="text-sm text-gray-600 mb-1">
          Тип: <span class="font-medium">{{ loc.type.name || '—' }}</span>
        </div>
        <div class="text-sm text-gray-600 mb-1">
          Статус: <span class="font-medium">{{ loc.status }}</span>
        </div>
        <p class="text-sm text-gray-700 mt-2">{{ loc.description?.toString() | truncateDescriptionPipe: 50 }}</p>
      </a>
    </div>

    <div class="flex justify-center mt-4">
      <pagination-controls (pageChange)="onTableDataChange($event)"></pagination-controls>

      <ng-template #emptyList>
        <div class="text-gray-500">Немає доступних локацій.</div>
      </ng-template>
    </div>
  </div>
</div>
